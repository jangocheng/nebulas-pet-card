webpackJsonp([4],{345:function(t,a,e){"use strict";function s(t){n||e(361)}Object.defineProperty(a,"__esModule",{value:!0});var r=e(352),i=e(362),n=!1,o=e(140),l=s,c=o(r.a,i.a,!1,l,"data-v-7c1f8842",null);c.options.__file="src/views/search.vue",a.default=c.exports},352:function(t,a,e){"use strict";var s=e(141),r=e(66),i=e(142),n=(e.n(i),new r.a);a.a={data:function(){return{account:null,id:"",avatar:"",name:"",birthday:"",remark:"",petCardId:"",loading:!0,found:!1,showNotfound:!1,interval:null,exCount:0,rewardValue:""}},computed:{fmtBirthday:function(){return this.birthday?s.a.dateFmt(this.birthday):"未知"}},watch:{$route:"getPetCard"},created:function(){var t=this;this.interval=setInterval(function(){t.exCount>5&&(clearInterval(t.interval),t.showError()),t.exCount++,t.initAccount()},1e3)},methods:{initAccount:function(){var t=localStorage.getItem("nasAddress");t&&(clearInterval(this.interval),this.account=i.Account.fromAddress(t),this.getPetCard())},showError:function(){this.$Modal.warning({title:"请先安装浏览器钱包插件",content:'<p>检测到你还没安装浏览器钱包插件，请先<a href="https://github.com/ChengOrangeJu/WebExtensionWallet" target="_blank">安装 NAS 钱包插件</a></p><br>\n                          <p>如果你还没有创建 NAS 钱包，可以参考官方教程进行创建「<a href="https://blog.nebulas.io/2018/04/12/creating-a-nas-wallet/" target="_blank">星云Web钱包教程1：创建NAS钱包</a>」</p><br>\n                          <p>确认导入钱包并解锁后，请刷新页面重新进行操作 :)</p>'})},getPetCard:function(){if(!this.account)return void this.showError();if("id"in this.$route.params){var t=s.a.getContractAddress(),a=this.$route.params.id,e=s.a.toSting([a]);n.simulateCall(t,"0","getPetCardById",e,{listener:this.setPetCardDetail})}},setPetCardDetail:function(t){if("null"===t.result||t.execute_err)this.found=!1,this.showNotfound=!0;else{var a=s.a.parse(t.result);this.id=a.id,this.avatar=a.photo,this.name=a.name,this.birthday=a.birthday,this.remark=a.remark,this.found=!0}this.loading=!1},handleLikeCallback:function(t){"string"!=typeof t?this.$Modal.success({title:"赞赏成功",content:"感谢您的赞赏 :)"}):this.$Modal.error({title:"交易取消",content:"赞赏失败 :("}),this.loading=!1},handleLikeClick:function(){var t=this;this.$Modal.confirm({render:function(a){return a("div",[a("p","* 赞赏单位为 NAS（1 NAS = 1EWei = 10^18 Wei）"),a("Input",{props:{value:t.rewardValue,autofocus:!0,placeholder:"请输入赞赏数额..."},on:{input:function(a){t.rewardValue=a}}})])},onOk:function(){t.loading=!0;var a=s.a.toSting([t.id]);n.call(s.a.getContractAddress(),t.rewardValue,"giveItReward",a,{listener:t.handleLikeCallback})}})},handleSearchClick:function(){var t=this.petCardId;this.$router.push("/search/"+t),this.loading=!0,this.showNotfound=!1}}}},361:function(t,a){},362:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"index pet-mb-160"},[e("Row",{staticClass:"pet-mb-32",attrs:{type:"flex",justify:"center",align:"middle"}},[e("Col",{staticStyle:{"text-align":"center"},attrs:{span:"12"}},[e("h2",{directives:[{name:"show",rawName:"v-show",value:t.showNotfound,expression:"showNotfound"}],staticClass:"pet-mb-32"},[t._v("没有找到 ID 为「"+t._s(t.$route.params.id)+"」的宠物卡，换个 ID 再试试看吧 :)")]),t._v(" "),e("Input",{staticClass:"pet-card-search",attrs:{placeholder:"输入宠物卡 ID 查找宠物身份信息..."},model:{value:t.petCardId,callback:function(a){t.petCardId=a},expression:"petCardId"}},[e("Button",{attrs:{slot:"append",icon:"ios-search"},nativeOn:{click:function(a){return t.handleSearchClick(a)}},slot:"append"})],1)],1)],1),t._v(" "),t.found?e("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[e("Col",{staticStyle:{"text-align":"center"},attrs:{span:"4"}},[e("Card",{staticClass:"pet-mb-32"},[e("Row",{staticClass:"pet-pt-16 pet-pb-16",attrs:{type:"flex",justify:"center",align:"middle"}},[e("Col",{attrs:{span:"24"}},[e("img",{staticClass:"pet-avatar",attrs:{src:t.avatar,alt:""}})]),t._v(" "),e("Col",{attrs:{span:"24"}},[e("Button",{attrs:{type:"error",shape:"circle",icon:"heart",size:"large"},on:{click:t.handleLikeClick}},[t._v("赞赏")]),t._v(" "),e("router-link",{attrs:{to:"/detail/"+t.id}},[e("Button",{attrs:{type:"ghost",shape:"circle",icon:"chatbubble-working",size:"large"}},[t._v("评论")])],1)],1)],1),t._v(" "),e("Row",{staticClass:"pet-pt-16 pet-pb-16",attrs:{type:"flex",justify:"center",align:"top"}},[e("Col",{attrs:{span:"24"}},[e("div",[e("Row",{attrs:{type:"flex",justify:"center",align:"top"}},[e("Col",{attrs:{span:"8"}},[e("p",{staticClass:"text-right"},[e("Icon",{attrs:{type:"at"}}),t._v(" ID")],1)]),t._v(" "),e("Col",{attrs:{span:"16"}},[e("p",{staticClass:"text-left"},[t._v(t._s(t.id))])]),t._v(" "),e("Col",{attrs:{span:"8"}},[e("p",{staticClass:"text-right"},[e("Icon",{attrs:{type:"social-octocat"}}),t._v("名称")],1)]),t._v(" "),e("Col",{attrs:{span:"16"}},[e("p",{staticClass:"text-left"},[t._v(t._s(t.name))])]),t._v(" "),e("Col",{attrs:{span:"8"}},[e("p",{staticClass:"text-right"},[e("Icon",{attrs:{type:"ios-paw"}}),t._v("生日")],1)]),t._v(" "),e("Col",{attrs:{span:"16"}},[e("p",{staticClass:"text-left"},[t._v(t._s(t.fmtBirthday))])])],1)],1)])],1)],1)],1)],1):t._e(),t._v(" "),t.loading?e("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},r=[];s._withStripped=!0;var i={render:s,staticRenderFns:r};a.a=i}});