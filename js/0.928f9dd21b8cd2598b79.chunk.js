webpackJsonp([0],{346:function(t,e,a){"use strict";function s(t){i||a(363)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(353),r=a(364),i=!1,o=a(140),l=s,c=o(n.a,r.a,!1,l,"data-v-68b3be6b",null);c.options.__file="src/views/detail.vue",e.default=c.exports},348:function(t,e,a){t.exports=a.p+"d36b382ab87824a77ba0d1d7f30b78de.png"},353:function(t,e,a){"use strict";var s=a(141),n=a(66),r=a(142),i=(a.n(r),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}),o=new n.a;e.a={data:function(){return{account:null,id:"",avatar:"",name:"",birthday:"",remark:"",comment:"",comments:[],petCardId:"",loading:!0,showNotfound:!1,interval:null,exCount:0,rewardValue:""}},computed:{fmtBirthday:function(){return this.birthday?s.a.dateFmt(this.birthday):"未知"}},filters:{dateFmt:function(t){if(t){var e="object"!==(void 0===t?"undefined":i(t))?new Date(1e3*t):t,a={year:e.getFullYear(),month:e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,day:e.getDate()<10?"0"+e.getDate():e.getDate(),hour:e.getHours()<10?"0"+e.getHours():e.getHours(),min:e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),sec:e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds()};return a.year+"年"+a.month+"月"+a.day+"日"}return"未知"}},watch:{$route:"getPetCardById"},created:function(){var t=this;this.interval=setInterval(function(){t.exCount>5&&(clearInterval(t.interval),t.showError()),t.exCount++,t.initAccount()},1e3)},methods:{initAccount:function(){var t=localStorage.getItem("nasAddress");t&&(clearInterval(this.interval),this.account=r.Account.fromAddress(t),this.getPetCardById(),this.getComments())},showError:function(){this.$Modal.warning({title:"请先安装浏览器钱包插件",content:'<p>检测到你还没安装浏览器钱包插件，请先<a href="https://github.com/ChengOrangeJu/WebExtensionWallet" target="_blank">安装 NAS 钱包插件</a></p><br>\n                          <p>如果你还没有创建 NAS 钱包，可以参考官方教程进行创建「<a href="https://blog.nebulas.io/2018/04/12/creating-a-nas-wallet/" target="_blank">星云Web钱包教程1：创建NAS钱包</a>」</p><br>\n                          <p>确认导入钱包并解锁后，请刷新页面重新进行操作 :)</p>'})},getPetCardById:function(){if(!this.account)return void this.showError();if("id"in this.$route.params){this.petCardId=this.$route.params.id;var t=s.a.getContractAddress(),e=s.a.toSting([this.petCardId]);o.simulateCall(t,"0","getPetCardById",e,{listener:this.setPetCardDetail})}},getComments:function(){var t=this,e=s.a.getContractAddress(),a=s.a.toSting([this.petCardId]);o.simulateCall(e,"0","getComments",a,{listener:function(e){var a=s.a.parse(e.result);a&&a.length&&(t.comments=a)}})},setPetCardDetail:function(t){if("null"===t.result||t.execute_err)this.showNotfound=!0;else{var e=s.a.parse(t.result);this.id=e.id,this.avatar=e.photo,this.name=e.name,this.birthday=e.birthday,this.remark=e.remark}this.loading=!1},handleCommentPost:function(){var t=this;this.loading=!0;var e=this.comment,a=s.a.getContractAddress(),n=s.a.toSting([this.petCardId,e]);o.call(a,"0","createComment",n,{listener:function(a){"string"!=typeof a?(t.$Modal.success({title:"评论成功",content:"你的评论已经发送出去啦~"}),t.comments.unshift({from:t.account.getAddressString(),content:e,sentTime:new Date})):t.$Modal.error({title:"评论失败",content:"交易被取消，评论失败 :("}),t.loading=!1}})},handleLikeCallback:function(t){"string"!=typeof t?this.$Modal.success({title:"赞赏成功",content:"感谢您的赞赏 :)"}):this.$Modal.error({title:"交易取消",content:"赞赏失败 :("}),this.loading=!1},handleLikeClick:function(){var t=this;this.$Modal.confirm({render:function(e){return e("div",[e("p","* 赞赏单位为 NAS（1 NAS = 1EWei = 10^18 Wei）"),e("Input",{props:{value:t.rewardValue,autofocus:!0,placeholder:"请输入赞赏数额..."},on:{input:function(e){t.rewardValue=e}}})])},onOk:function(){t.loading=!0;var e=s.a.toSting([t.id]);o.call(s.a.getContractAddress(),t.rewardValue,"giveItReward",e,{listener:t.handleLikeCallback})}})}}}},363:function(t,e){},364:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"index"},[s("Row",{staticClass:"pet-mb-32",attrs:{type:"flex",justify:"center",align:"middle"}},[s("Col",{staticStyle:{"text-align":"center"},attrs:{span:"12"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showNotfound,expression:"showNotfound"}],staticStyle:{"text-align":"center"}},[s("h1",[s("img",{attrs:{src:a(348),alt:""}})]),t._v(" "),s("h2",{staticClass:"pet-mb-32"},[t._v("这里已经好像没有你要找的东西~")]),t._v(" "),s("router-link",{attrs:{to:"/"}},[s("Button",{attrs:{type:"primary",size:"large"}},[t._v("返回首页")])],1),t._v(" "),s("router-link",{attrs:{to:"/account"}},[s("Button",{attrs:{type:"ghost",size:"large"}},[t._v("个人中心")])],1)],1)])],1),t._v(" "),t.showNotfound?t._e():s("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[s("Col",{staticStyle:{"text-align":"center"},attrs:{span:"12"}},[s("Card",{staticClass:"pet-mb-32"},[s("Row",{staticClass:"pet-pt-16 pet-pb-16",attrs:{type:"flex",justify:"center",align:"top"}},[s("Col",{attrs:{span:"8"}},[s("img",{staticClass:"pet-avatar",attrs:{src:t.avatar,alt:""}})]),t._v(" "),s("Col",{attrs:{span:"16"}},[s("div",[s("Row",{attrs:{type:"flex",justify:"center",align:"top"}},[s("Col",{attrs:{span:"8"}},[s("p",{staticClass:"text-right"},[s("Icon",{attrs:{type:"at"}}),t._v(" ID")],1)]),t._v(" "),s("Col",{attrs:{span:"16"}},[s("p",{staticClass:"text-left"},[t._v(t._s(t.id))])]),t._v(" "),s("Col",{attrs:{span:"8"}},[s("p",{staticClass:"text-right"},[s("Icon",{attrs:{type:"social-octocat"}}),t._v("名称")],1)]),t._v(" "),s("Col",{attrs:{span:"16"}},[s("p",{staticClass:"text-left"},[t._v(t._s(t.name))])]),t._v(" "),s("Col",{attrs:{span:"8"}},[s("p",{staticClass:"text-right"},[s("Icon",{attrs:{type:"ios-paw"}}),t._v("生日")],1)]),t._v(" "),s("Col",{attrs:{span:"16"}},[s("p",{staticClass:"text-left"},[t._v(t._s(t.fmtBirthday))])]),t._v(" "),s("Col",{attrs:{span:"8"}},[s("p",{staticClass:"text-right"},[s("Icon",{attrs:{type:"heart"}}),t._v("主人寄语")],1)]),t._v(" "),s("Col",{attrs:{span:"16"}},[s("p",{staticClass:"text-left"},[t._v(t._s(t.remark))])])],1)],1)]),t._v(" "),s("Col",{attrs:{span:"24"}},[s("Button",{attrs:{type:"error",shape:"circle",icon:"heart",size:"large"},on:{click:t.handleLikeClick}},[t._v("赞赏")])],1)],1)],1)],1)],1),t._v(" "),t.showNotfound?t._e():s("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[s("Col",{attrs:{span:"12"}},[s("div",[s("Input",{attrs:{type:"textarea",rows:4,placeholder:"萌宠真可爱，夸夸 ta 吧..."},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),t._v(" "),s("Button",{staticClass:"pet-mt-8",attrs:{type:"primary",size:"large"},on:{click:t.handleCommentPost}},[t._v("发表评论")])],1),t._v(" "),s("div",[t.comments.length>0?s("Card",{staticClass:"pet-mb-32 pet-mt-8"},[s("p",{attrs:{slot:"title"},slot:"title"},[s("Icon",{attrs:{type:"chatbubbles"}}),t._v("\n                        全部评论\n                    ")],1),t._v(" "),s("ul",{staticClass:"pet-comments"},t._l(t.comments,function(e,a){return s("li",{key:a},[s("p",[t._v("来自："+t._s(e.from)+" - 发布时间："+t._s(t._f("dateFmt")(e.sentTime)))]),t._v(" "),s("p",{staticClass:"pet-comment"},[t._v(t._s(e.content))])])}))]):t._e()],1)])],1),t._v(" "),t.loading?s("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},n=[];s._withStripped=!0;var r={render:s,staticRenderFns:n};e.a=r}});